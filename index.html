<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dual-Use Challenge: Human vs AI Agent</title>
    <style>
        body { font-family: 'Open Sans', Arial, sans-serif; background-color: #000; color: #fff; margin: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        .hidden { display: none !important; }
        
        /* Header */
        .header { height: 70px; display: flex; justify-content: space-between; align-items: center; padding: 0 30px; border-bottom: 3px solid #86bc25; background: #111; }
        .logo-img { height: 35px; }
        
        /* Main Layout */
        #main-view { display: flex; flex: 1; width: 100%; }
        .play-zone { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; border-right: 1px solid #333; position: relative; }
        .ai-zone { background: #0a0a0a; border-right: none; }

        /* Screens Overlay */
        #reg-screen, #results-screen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .reg-box { background: #111; padding: 30px; border-top: 6px solid #86bc25; width: 350px; text-align: center; }

        /* Gameplay Elements */
        .card { background: #1a1a1a; padding: 15px; border-radius: 4px; width: 100%; max-width: 320px; text-align: center; border: 1px solid #333; }
        .product-display { width: 100%; height: 200px; object-fit: contain; background: #000; margin: 10px 0; border: 1px solid #222; transition: opacity 0.5s; }
        input { width: 100%; padding: 10px; margin: 5px 0; background: #222; border: 1px solid #444; color: #fff; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; background: #86bc25; color: #000; font-weight: bold; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        .secondary-btn { background: #444; color: #fff; font-size: 0.8rem; }
        
        /* AI Performance Visuals */
        .ai-status { color: #86bc25; font-family: monospace; font-size: 0.75rem; height: 20px; margin-bottom: 5px; text-transform: uppercase; }
        .prob-bar { width: 100%; height: 4px; background: #222; margin: 10px 0; }
        .prob-fill { height: 100%; background: #86bc25; width: 0%; transition: width 0.2s; }
        .label { position: absolute; top: 10px; left: 20px; font-weight: bold; color: #86bc25; font-size: 0.8rem; letter-spacing: 1px; text-transform: uppercase; }

        /* Slider Overlay */
        #slider-overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #slider-img { max-width: 95%; max-height: 85vh; object-fit: contain; }
    </style>
</head>
<body>

<div id="slider-overlay" class="hidden">
    <button style="width: auto; padding: 10px 20px; margin-bottom: 10px;" onclick="toggleSlider()">CLOSE [X]</button>
    <img src="images/oneslider.png" id="slider-img">
</div>

<div id="reg-screen">
    <div class="reg-box">
        <img src="images/logo2.png" style="height:30px; margin-bottom:20px;">
        <h2>Human vs AI Agent</h2>
        <input type="text" id="reg-name" placeholder="Full Name">
        <input type="text" id="reg-company" placeholder="Company">
        <input type="text" id="reg-role" placeholder="Role">
        <input type="email" id="reg-email" placeholder="Email">
        <button id="start-btn">Start Game</button>
        <button class="secondary-btn" onclick="toggleSlider()">Show Info Slide</button>
        <p><a href="leaderboard.html" style="color:#86bc25; text-decoration:none; font-size:0.8rem;">üèÜ View Global Leaderboard</a></p>
    </div>
</div>

<div class="header">
    <img src="images/logo2.png" class="logo-img">
    <div id="timer-display" style="font-size: 1.8rem; font-family: monospace; color:#86bc25; font-weight: bold;">01:00</div>
    <div style="text-align: right; font-size: 0.9rem;">
        <div>HUMAN SCORE: <span id="h-score-val">0</span></div>
        <div style="color: #86bc25;">AI AGENT SCORE: <span id="ai-score-val">0</span></div>
    </div>
</div>

<div id="main-view" class="hidden">
    <div class="play-zone">
        <div class="label">Human Specialist</div>
        <div class="card">
            <img id="h-img" class="product-display" src="">
            <h4 id="h-name">...</h4>
            <div style="display:flex; gap:10px;">
                <button onclick="humanGuess(false)" style="background:#444; color:#fff; width: 50%;">Consumer</button>
                <button onclick="humanGuess(true)" style="width: 50%;">Dual-Use</button>
            </div>
        </div>
    </div>

    <div class="play-zone ai-zone">
        <div class="label">AI Agent</div>
        <div class="card" style="border-color: #86bc25;">
            <div id="ai-log" class="ai-status">System Ready</div>
            <img id="ai-img" class="product-display" src="">
            <div id="ai-name-box">
                <h4 id="ai-name">Initializing...</h4>
            </div>
            <div class="prob-bar"><div id="ai-prob" class="prob-fill"></div></div>
            <div style="display:flex; gap:10px; opacity: 0.1;">
                <button disabled>Consumer</button>
                <button disabled>Dual-Use</button>
            </div>
        </div>
    </div>
</div>

<div id="results-screen" class="hidden">
    <h1 style="color:#86bc25;">GAME OVER</h1>
    <div style="display:flex; gap:50px; text-align:center; margin-bottom: 30px;">
        <div><h3>HUMAN</h3><h2 id="final-h" style="font-size: 3rem;">0</h2></div>
        <div style="border-left:1px solid #333; padding-left:50px;"><h3 style="color:#86bc25;">AI AGENT</h3><h2 id="final-ai" style="color:#86bc25; font-size: 3rem;">0</h2></div>
    </div>
    <button onclick="location.href='leaderboard.html'" style="width:280px;">Global Leaderboard</button>
    <button class="secondary-btn" onclick="location.reload()" style="width:280px;">Play Again</button>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz0CZBIqFlmBkGIZoU6yVFDak_B4FhkqnvnEUl7ZILjOVWq9-5htipRMk_zeqWZ_ZOoyg/exec";

    const products = [
        { name: "GPS for Cars", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTUIU05FOfL-VUxBLF8z2PxyB8zwnhwuRgJ5A&s", isDualUse: false },
        { name: "Carbon Fiber Roll", image: "https://m.media-amazon.com/images/I/81PsiYlPIVL._AC_UF894,1000_QL80_.jpg", isDualUse: true },
        { name: "Luxury Smartwatch", image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?q=80&w=500", isDualUse: false },
        { name: "Industrial Magnet", image: "https://www.cmtcompanies.com/wp-content/uploads/2017/01/57-DASH-magnet.jpg", isDualUse: true },
        { name: "Nitrogen Tank (Resistant Alloy)", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTA2Dd9blOb5taCLB5qW-FF6U_eVyg-JNnZvg&s", isDualUse: true },
        { name: "Satellite Phone", image: "https://www.officeeasy.be/media/catalog/product/cache/16822256cee3c919bf29bfc0144d0975/i/r/iridium_extreme.jpg", isDualUse: true },
        { name: "Instant Coffee", image: "https://images.unsplash.com/photo-1559056199-641a0ac8b55e?q=80&w=500", isDualUse: false },
        { name: "Laboratory Centrifuge", image: "https://m.media-amazon.com/images/I/61g+cYn2kyL._AC_UF894,1000_QL80_.jpg", isDualUse: true },
        { name: "Steel Pipe (High Spec)", image: "https://yenaengineering.nl/wp-content/uploads/2021/08/image.jpeg", isDualUse: true },
        { name: "Encryption Software", image: "https://images.unsplash.com/photo-1563986768609-322da13575f3?q=80&w=500", isDualUse: true },
        { name: "Industrial Fertilizer", image: "https://images.unsplash.com/photo-1628352081506-83c43123ed6d?q=80&w=500", isDualUse: false },
        { name: "Solar Panel", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTaHUI-Bvr5LxlJcF-hgywBzy_7lj4EZ_fUrA&s", isDualUse: false },
        { name: "High-Performance GPU", image: "https://images.unsplash.com/photo-1591488320449-011701bb6704?q=80&w=500", isDualUse: true },
        { name: "Furbie Toy", image: "https://media-cldnry.s-nbcnews.com/image/upload/t_fit-560w,f_auto,q_auto:best/streams/2012/August/120806/347363-furby.jpg", isDualUse: false },
        { name: "Laser Cutting Machine", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSRT9RsSsxHUuk1vWWRjHB-pnRH0o6GBX0LyQ&s", isDualUse: true },
        { name: "Laptop Computer", image: "https://images.unsplash.com/photo-1496181133206-80ce9b88a853?q=80&w=500", isDualUse: false },
        { name: "Maraging Steel Plate", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTXsbdXgTyUmTXBOyhIVwzA_nm19OZXqF0PvA&s", isDualUse: true },
        { name: "Microwave Oven", image: "https://images.unsplash.com/photo-1574269909862-7e1d70bb8078?q=80&w=500", isDualUse: false },
        { name: "Aluminum Powder", image: "https://m.media-amazon.com/images/I/31nzZAXwywL._AC_UF1000,1000_QL80_.jpg", isDualUse: true },
        { name: "3D Printer", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRqxaGChmXB4lHNgCxOiI-vGLCWYIOOotsHBw&s", isDualUse: false },
        { name: "Submersible Pump", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTCd3SnUnK2N15maZwuwtbuqkMdhMDOEZqx8w&s", isDualUse: true },
        { name: "Glass Wool", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRfoDE-SZKNUyH93ypfcE4pQ5aErVzadPHdQQ&s", isDualUse: false },
        { name: "Night Vision Goggles", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRNZOFZhwOGjZtPGdmkgVCALUTuwX1-nA9Cfw&s", isDualUse: true },
        { name: "Consumer Drone", image: "https://images.unsplash.com/photo-1507582020474-9a35b7d455d9?q=80&w=500", isDualUse: true },
        { name: "Diesel Generator", image: "https://www.auto-service.be/assets/media/29748/diesel-generator-geluidsgedempt-230v400v-10kva-3.jpg", isDualUse: false },
        { name: "Digital Oscilloscope", image: "https://be.farnell.com/productimages/large/en_GB/3228047-40.jpg", isDualUse: true },
        { name: "Nickel Alloy", image: "https://specialpipingmaterials.com/wp-content/uploads/2019/07/Copy-of-Untitled-2-1.png", isDualUse: true },
        { name: "Fiber Optic Cable", image: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=500", isDualUse: true },
        { name: "Vacuum Pump", image: "https://cbeuptime.com/wp-content/uploads/2015/03/industrial-vacuum-pump-compressor-picture-id1152748867.jpg", isDualUse: true },
        { name: "Titanium Rods", image: "https://m.media-amazon.com/images/I/71mI-+fS9EL._AC_UF1000,1000_QL80_.jpg", isDualUse: true },
        { name: "Industrial Smoke Detector", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSt-3Q2qHWY7wL9Lpx-pKXiXU92oXrqeEVXbw&s", isDualUse: false },
        { name: "Server Rack", image: "https://cdn11.bigcommerce.com/s-bmqf4dxrop/images/stencil/1030x680/uploaded_images/uploaded_images/untitled-design-7-1-.png?t=1733945236", isDualUse: false },
        { name: "Microscope", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT-XgSkqXloXilxRV2f_LfRXGnoe4v0U8mJAA&s", isDualUse: false },
        { name: "Pressure Sensor", image: "https://res.cloudinary.com/rsc/image/upload/b_rgb:FFFFFF,c_pad,dpr:2.625,f_auto,h:214,q_auto,w:380/c_pad,h:214,w_380/F8285729-01?pgw:1", isDualUse: true },
        { name: "High-Speed Camera", image: "https://images.unsplash.com/photo-1516035069371-29a1b244cc32?q=80&w=500", isDualUse: true },
        { name: "Ball Bearings", image: "https://m.media-amazon.com/images/I/61IqIz62s6L.jpg", isDualUse: true },
        { name: "Graphite Electrodes", image: "https://www.eastcarb.com/wp-content/uploads/2024/10/What-is-Graphite-Electrode.png", isDualUse: true },
        { name: "Thermal Imaging Camera", image: "https://m.media-amazon.com/images/I/61y5QhiHmSL._AC_UF1000,1000_QL80_.jpg", isDualUse: true },
        { name: "Scuba Regulator", image: "https://www.scuba.com/blog/wp-content/uploads/2023/11/scuba-diving-regulator-octo-AdobeStock_254364233.jpg", isDualUse: false },
        { name: "Microprocessor Chips", image: "https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=500", isDualUse: true },
        { name: "Industrial Robot Arm", image: "https://images.unsplash.com/photo-1535378917042-10a22c95931a?q=80&w=500", isDualUse: true },
        { name: "Dental Drill", image: "https://images.unsplash.com/photo-1598256989800-fe5f95da9787?q=80&w=500", isDualUse: false }
    ];

    let hIdx = 0, aiIdx = 0, hScore = 0, aiScore = 0, timeLeft = 60, isActive = false, userData = {};
    let aiStartTime, aiMistakes = 0;

    function toggleSlider() { document.getElementById('slider-overlay').classList.toggle('hidden'); }

    function startSimulation() {
        userData = {
            name: document.getElementById('reg-name').value,
            company: document.getElementById('reg-company').value,
            role: document.getElementById('reg-role').value,
            email: document.getElementById('reg-email').value
        };
        if(!userData.name || !userData.email) return alert("Please fill Name/Email");

        document.getElementById('reg-screen').classList.add('hidden');
        document.getElementById('main-view').classList.remove('hidden');
        
        isActive = true;
        aiStartTime = Date.now();
        updateH();
        updateAI();

        const timer = setInterval(() => {
            timeLeft--;
            document.getElementById('timer-display').innerText = `00:${timeLeft < 10 ? '0'+timeLeft : timeLeft}`;
            if(timeLeft <= 0 || (hIdx >= products.length && aiIdx >= products.length)) { 
                clearInterval(timer); 
                endSim(); 
            }
        }, 1000);

        runAILoop();
    }

    function updateH() {
        if(hIdx < products.length) {
            document.getElementById('h-img').src = products[hIdx].image;
            document.getElementById('h-name').innerText = products[hIdx].name;
        } else {
            document.getElementById('h-name').innerText = "Queue Finished";
            document.getElementById('h-img').style.opacity = "0.1";
        }
    }

    function humanGuess(guess) {
        if(!isActive || hIdx >= products.length) return;
        if(guess === products[hIdx].isDualUse) hScore++;
        document.getElementById('h-score-val').innerText = hScore;
        hIdx++;
        updateH();
    }

    async function runAILoop() {
        while(isActive && aiIdx < products.length) {
            updateAI();
            const log = document.getElementById('ai-log');
            const prob = document.getElementById('ai-prob');

            log.innerText = "Analyzing Metadata...";
            prob.style.width = "40%";
            await new Promise(r => setTimeout(r, 400));

            log.innerText = "Classifying dual-use...";
            prob.style.width = "90%";
            await new Promise(r => setTimeout(r, 200));

            // 92% Accuracy Logic
            if(Math.random() < 0.92) {
                aiScore++;
            } else {
                aiMistakes++;
            }

            document.getElementById('ai-score-val').innerText = aiScore;
            aiIdx++;
            prob.style.width = "0%";
            await new Promise(r => setTimeout(r, 50));
        }
        
        if (isActive) {
            const totalSec = ((Date.now() - aiStartTime) / 1000).toFixed(1);
            document.getElementById('ai-log').innerText = "QUEUE COMPLETED";
            document.getElementById('ai-name-box').innerHTML = `
                <div style="color:#86bc25; font-size:1.1rem; margin-top:10px;">Batch Classified</div>
                <div style="font-size:0.85rem; margin-top:5px; color:#aaa;">
                    Items: ${products.length} <br>
                    Time: ${totalSec}s <br>
                    Mistakes: ${aiMistakes}
                </div>
            `;
            document.getElementById('ai-img').style.opacity = "0.1";
        }
    }

    function updateAI() {
        if(aiIdx < products.length) {
            document.getElementById('ai-img').src = products[aiIdx].image;
            document.getElementById('ai-name').innerText = products[aiIdx].name;
        }
    }

    function endSim() {
        if (!isActive) return;
        isActive = false;
        document.getElementById('results-screen').classList.remove('hidden');
        document.getElementById('final-h').innerText = hScore;
        document.getElementById('final-ai').innerText = aiScore;
        
        fetch(SCRIPT_URL, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify({ ...userData, score: hScore }) 
        });
    }

    document.getElementById('start-btn').addEventListener('click', startSimulation);
</script>
</body>
</html>